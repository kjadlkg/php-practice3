# **Authentication & Authorization Vulnerability**

**인증**과 **인가**의 차이점은 다음과 같다.

- **인증(Authentication)**: 사용자가 본인인지 확인하는 과정 (예: 로그인(ID/PW, OTP, 생체 인식 등))

- **인가(Authorization)**: 인증된 사용자가 특정 리소스에 접근할 수 있도록 확인하는 과정 (예: 관리자만 대시보드 접근 가능)

<br>
<br>

## **인증 Authentication 관련 취약점**

쿠키를 통한 인증의 경우 쿠키는 클라이언트 측에 저장된 정보이기 때문에 공격자가 자바스크립트를 이용해 쉽게 탈취가 가능하다.

본인 인증 과정에서 인증 절차를 건너뛸 수 있는 취약점이 존재할 수 있다.

회원가입의 경우, **약관 동의 > 본인 인증 > 회원 가입**의 순으로 이어지는데,
인증이 충분히 구현되어있지 않은 경우에는 url 조작을 통해 **약관 동의 > 회원가입**와 같이 중간의 과정을 건너뛸 수 있다.

### 1. Weak Passwords, 약한 비밀번호

사용자가 너무 쉬운 비밀번호(`123456`, `password`, `qwerty`)를 설정하면 공격자는 이러한 쉬운 비밀번호를 입력하여 쉽게 로그인 가능해진다.

**방어 방법**:

- 최소 8~12 이상(대소문자, 숫자, 특수문자 포함) 강력한 비밀번호 사용
- 비밀번호 재사용 방지 (이전 비밀번호 사용 금지)
- 비밀번호 입력 시도 횟수 제한 및 계정 잠금

<br>

### 2. Brute Force Attack, 무차별 대입 공격

: 공격자가 가능한 모든 비밀번호 조합을 시도하여 로그인하는 공격

인증 횟수에 제한이 없는 경우 이 공격으로 인해 숫자 4~6자리 정도는 쉽게 알아낼 수 있다.

예를 들어, 공격자가 `admin` 계정에 대해 수천 개의 비밀번호를 자동 입력하여 맞는 비밀번호가 나오면 로그인에 성공한다.

**방어 방법**:

- 일정 횟수 로그인 실패 시 계정 잠금
- CAPTCHA 적용
- 2단계 인증(OTP, SMS) 사용

<br>

### 3. Credential Stuffing

: 다른 웹사이트에서 유출된 아이디/비밀번호를 사용하여 로그인 시도하는 공격

공격자가 다크웹에서 유출된 이메일/비밀번호 목록을 다운하여
여러 사이트에 동일한 계정 정보로 로그인을 시도할 수 있다.

**방어 방법**:

- 비밀번호 재사용 금지 (모든 사이트에서 다르게 설정)
- 2단계 인증 적용
- 로그인 시도 시 비정상적인 활동 감지

<br>

### 4. Authentication Bypass, 인증 우회

: 인증 로직의 취약점을 이용하여 로그인 없이 시스템 접근

SQL Injection을 이용한 로그인 우회의 경우

```sql
SELECT * FROM users WHERE username = 'admin' AND password = '' OR '1'='1';
```

`'1'='1'`조건이 항상 참이므로 로그인이 가능해진다.

**방어 방법**:

- SQL Injection 방어
- 로그인 로직 철저한 검증

<br>

### 5. Session Hijacking, 세션 탈취

: 사용자의 세션 쿠키를 탈취하여 공격자가 로그인 상태를 가로채는 공격

피해자가 로그인 후 공격자가 악성 스크립트를 실행한다. (XSS 공격)

피해자의 세션 쿠키를 공격자에게 전송하고 공격자가 쿠키를 사용하여 피해자 계정으로 로그인 한다.

**방어 방법**:

- `HttpOnly`, `Secure`, `SameSite` 속성을 설정하여 쿠키 보호
- HTTPS를 적용하여 네트워크에서 가로채기 방지
- 세션 만료 및 재인증 기능 적용

<br>
<br>

## **인가 Authorization 관련 취약점**

주석이나 CSS 등 클라이언트 측에서 권한 체크를 하는 경우에도 취약점이 존재할 수 있다.

주석에 포함된 정보를 참조하여 중요 기능에 접근하거나
CSS에서 `display:none;`을 사용하여 숨겨진 기능이 존재할 경우 해당 코드만 삭제하여 접근하는 방식도 존재한다.

### 1. Privilege Escalation, 수직적 권한 상승

: 일반 사용자가 관리자 권한을 얻는 공격

공격자가 웹 요청을 가로채서 자신의 role을 "admin"으로 변경하여 관리자 페이지 접근이 가능해진다.

**방어 방법**:

- 중요한 요청은 서버에서 사용자 권한을 재검사
- 관리자 기능에는 추가 인증 적용

<br>

### 2. Insecure Direct Object Reference, IDOR, 수평적 권한 상승

: 다른 사용자의 데이터를 불법적으로 접근하는 공격

```bash
// 사용자가 자신의 프로필을 조회하는 API 요청
GET /user/1001/profile
```

```bash
// 공격자가 URL을 변경하여 다른 사용자의 정보를 조회
GET /user/1002/profile
```

이러한 과정을 통해 다른 사용자의 정보가 노출될 수 있다.

**방어 방법**:

- 요청을 받을 때 사용자 ID와 세션 ID를 검증
- 접근 가능한 리소스만 조회하도록 백엔드에서 체크
